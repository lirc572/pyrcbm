/* //////////////// generated by ulog2rcbm ////////////////
- filePrefix
- data -- [[timestamp_in_ms, pwm_output], [..., ...], ...]
- samplesAvg
///////////// User defined variables //////////// */

const filePrefix = "sin_wave";
const data = [[0.0,1979],[0.025,1982],[0.05,1985],[0.075,1988],[0.1,1991],[0.125,1993],[0.15,1995],[0.175,1996],[0.2,1998],[0.225,1999],[0.25,1999],[0.275,1999],[0.3,1999],[0.325,1999],[0.35,1999],[0.375,1998],[0.4,1996],[0.425,1995],[0.45,1993],[0.475,1991],[0.5,1988],[0.525,1985],[0.55,1982],[0.575,1979],[0.6,1975],[0.625,1971],[0.65,1967],[0.675,1962],[0.7,1958],[0.725,1952],[0.75,1947],[0.775,1941],[0.8,1935],[0.825,1929],[0.85,1922],[0.875,1916],[0.9,1909],[0.925,1901],[0.95,1894],[0.975,1886],[1.0,1878],[1.025,1870],[1.05,1861],[1.075,1852],[1.1,1843],[1.125,1834],[1.15,1825],[1.175,1815],[1.2,1805],[1.225,1795],[1.25,1785],[1.275,1775],[1.3,1764],[1.325,1754],[1.35,1743],[1.375,1732],[1.4,1721],[1.425,1709],[1.45,1698],[1.475,1687],[1.5,1675],[1.525,1663],[1.55,1651],[1.575,1639],[1.6,1627],[1.625,1615],[1.65,1603],[1.675,1591],[1.7,1578],[1.725,1566],[1.75,1554],[1.775,1541],[1.8,1529],[1.825,1516],[1.85,1504],[1.875,1491],[1.9,1479],[1.925,1466],[1.95,1454],[1.975,1441],[2.0,1429],[2.025,1417],[2.05,1404],[2.075,1392],[2.1,1380],[2.125,1368],[2.15,1356],[2.175,1344],[2.2,1332],[2.225,1320],[2.25,1309],[2.275,1297],[2.3,1286],[2.325,1275],[2.35,1263],[2.375,1253],[2.4,1242],[2.425,1231],[2.45,1221],[2.475,1210],[2.5,1200],[2.525,1190],[2.55,1181],[2.575,1171],[2.6,1162],[2.625,1153],[2.65,1144],[2.675,1135],[2.7,1127],[2.725,1118],[2.75,1110],[2.775,1103],[2.8,1095],[2.825,1088],[2.85,1081],[2.875,1074],[2.9,1068],[2.925,1062],[2.95,1056],[2.975,1050],[3.0,1045],[3.025,1040],[3.05,1035],[3.075,1031],[3.1,1026],[3.125,1022],[3.15,1019],[3.175,1016],[3.2,1013],[3.225,1010],[3.25,1008],[3.275,1005],[3.3,1004],[3.325,1002],[3.35,1001],[3.375,1000],[3.4,1000],[3.425,1000],[3.45,1000],[3.475,1000],[3.5,1001],[3.525,1002],[3.55,1003],[3.575,1005],[3.6,1007],[3.625,1009],[3.65,1012],[3.675,1015],[3.7,1018],[3.725,1021],[3.75,1025],[3.775,1029],[3.8,1033],[3.825,1038],[3.85,1043],[3.875,1048],[3.9,1054],[3.925,1060],[3.95,1066],[3.975,1072],[4.0,1079],[4.025,1086],[4.05,1093],[4.075,1100],[4.1,1108],[4.125,1116],[4.15,1124],[4.175,1132],[4.2,1141],[4.225,1150],[4.25,1159],[4.275,1168],[4.3,1177],[4.325,1187],[4.35,1197],[4.375,1207],[4.4,1217],[4.425,1228],[4.45,1238],[4.475,1249],[4.5,1260],[4.525,1271],[4.55,1282],[4.575,1293],[4.6,1305],[4.625,1316],[4.65,1328],[4.675,1340],[4.7,1352],[4.725,1364],[4.75,1376],[4.775,1388],[4.8,1400],[4.825,1412],[4.85,1425],[4.875,1437],[4.9,1450],[4.925,1462],[4.95,1475],[4.975,1487],[5.0,1500],[5.025,1512],[5.05,1524],[5.075,1537],[5.1,1549],[5.125,1562],[5.15,1574],[5.175,1587],[5.2,1599],[5.225,1611],[5.25,1623],[5.275,1635],[5.3,1647],[5.325,1659],[5.35,1671],[5.375,1683],[5.4,1694],[5.425,1706],[5.45,1717],[5.475,1728],[5.5,1739],[5.525,1750],[5.55,1761],[5.575,1771],[5.6,1782],[5.625,1792],[5.65,1802],[5.675,1812],[5.7,1822],[5.725,1831],[5.75,1840],[5.775,1849],[5.8,1858],[5.825,1867],[5.85,1875],[5.875,1883],[5.9,1891],[5.925,1899],[5.95,1906],[5.975,1913],[6.0,1920],[6.025,1927],[6.05,1933],[6.075,1939],[6.1,1945],[6.125,1951],[6.15,1956],[6.175,1961],[6.2,1966],[6.225,1970],[6.25,1974],[6.275,1978],[6.3,1981],[6.325,1984],[6.35,1987],[6.375,1990],[6.4,1992],[6.425,1994],[6.45,1996],[6.475,1997],[6.5,1998],[6.525,1999],[6.55,1999],[6.575,1999],[6.6,1999],[6.625,1999],[6.65,1998],[6.675,1997],[6.7,1995],[6.725,1994],[6.75,1991],[6.775,1989],[6.8,1986],[6.825,1983],[6.85,1980],[6.875,1977],[6.9,1973],[6.925,1968],[6.95,1964],[6.975,1959],[7.0,1954],[7.025,1949],[7.05,1943],[7.075,1937],[7.1,1931],[7.125,1925],[7.15,1918],[7.175,1911],[7.2,1904],[7.225,1896],[7.25,1889],[7.275,1881],[7.3,1872],[7.325,1864],[7.35,1855],[7.375,1846],[7.4,1837],[7.425,1828],[7.45,1818],[7.475,1809],[7.5,1799],[7.525,1789],[7.55,1778],[7.575,1768],[7.6,1757],[7.625,1746],[7.65,1736],[7.675,1724],[7.7,1713],[7.725,1702],[7.75,1690],[7.775,1679],[7.8,1667],[7.825,1655],[7.85,1643],[7.875,1631],[7.9,1619],[7.925,1607],[7.95,1595],[7.975,1582],[8.0,1570],[8.025,1558],[8.05,1545],[8.075,1533],[8.1,1520],[8.125,1508],[8.15,1495],[8.175,1483],[8.2,1470],[8.225,1458],[8.25,1445],[8.275,1433],[8.3,1421],[8.325,1408],[8.35,1396],[8.375,1384],[8.4,1372],[8.425,1360],[8.45,1348],[8.475,1336],[8.5,1324],[8.525,1312],[8.55,1301],[8.575,1290],[8.6,1278],[8.625,1267],[8.65,1256],[8.675,1245],[8.7,1235],[8.725,1224],[8.75,1214],[8.775,1204],[8.8,1194],[8.825,1184],[8.85,1174],[8.875,1165],[8.9,1156],[8.925,1147],[8.95,1138],[8.975,1129],[9.0,1121],[9.025,1113],[9.05,1105],[9.075,1098],[9.1,1090],[9.125,1083],[9.15,1077],[9.175,1070],[9.2,1064],[9.225,1058],[9.25,1052],[9.275,1047],[9.3,1041],[9.325,1037],[9.35,1032],[9.375,1028],[9.4,1024],[9.425,1020],[9.45,1017],[9.475,1014],[9.5,1011],[9.525,1008],[9.55,1006],[9.575,1004],[9.6,1003],[9.625,1001],[9.65,1000],[9.675,1000],[9.7,1000],[9.725,1000],[9.75,1000],[9.775,1000],[9.8,1001],[9.825,1003],[9.85,1004],[9.875,1006],[9.9,1008],[9.925,1011],[9.95,1014],[9.975,1017],[10.0,1020],[10.025,1024],[10.05,1028],[10.075,1032],[10.1,1037],[10.125,1041],[10.15,1047],[10.175,1052],[10.2,1058],[10.225,1064],[10.25,1070],[10.275,1077],[10.3,1083],[10.325,1090],[10.35,1098],[10.375,1105],[10.4,1113],[10.425,1121],[10.45,1129],[10.475,1138],[10.5,1147],[10.525,1156],[10.55,1165],[10.575,1174],[10.6,1184],[10.625,1194],[10.65,1204],[10.675,1214],[10.7,1224],[10.725,1235],[10.75,1245],[10.775,1256],[10.8,1267],[10.825,1278],[10.85,1290],[10.875,1301],[10.9,1313],[10.925,1324],[10.95,1336],[10.975,1348],[11.0,1360],[11.025,1372],[11.05,1384],[11.075,1396],[11.1,1408],[11.125,1421],[11.15,1433],[11.175,1446],[11.2,1458],[11.225,1470],[11.25,1483],[11.275,1495],[11.3,1508],[11.325,1520],[11.35,1533],[11.375,1545],[11.4,1558],[11.425,1570],[11.45,1583],[11.475,1595],[11.5,1607],[11.525,1619],[11.55,1631],[11.575,1643],[11.6,1655],[11.625,1667],[11.65,1679],[11.675,1690],[11.7,1702],[11.725,1713],[11.75,1725],[11.775,1736],[11.8,1747],[11.825,1757],[11.85,1768],[11.875,1778],[11.9,1789],[11.925,1799],[11.95,1809],[11.975,1818],[12.0,1828],[12.025,1837],[12.05,1846],[12.075,1855],[12.1,1864],[12.125,1872],[12.15,1881],[12.175,1889],[12.2,1896],[12.225,1904],[12.25,1911],[12.275,1918],[12.3,1925],[12.325,1931],[12.35,1937],[12.375,1943],[12.4,1949],[12.425,1954],[12.45,1959],[12.475,1964],[12.5,1968],[12.525,1973],[12.55,1977],[12.575,1980],[12.6,1983],[12.625,1986],[12.65,1989],[12.675,1992],[12.7,1994],[12.725,1995],[12.75,1997],[12.775,1998],[12.8,1999],[12.825,1999],[12.85,1999],[12.875,1999],[12.9,1999],[12.925,1998],[12.95,1997],[12.975,1996],[13.0,1994],[13.025,1992],[13.05,1990],[13.075,1987],[13.1,1984],[13.125,1981],[13.15,1978],[13.175,1974],[13.2,1970],[13.225,1965],[13.25,1961],[13.275,1956],[13.3,1951],[13.325,1945],[13.35,1939],[13.375,1933],[13.4,1927],[13.425,1920],[13.45,1913],[13.475,1906],[13.5,1899],[13.525,1891],[13.55,1883],[13.575,1875],[13.6,1867],[13.625,1858],[13.65,1849],[13.675,1840],[13.7,1831],[13.725,1822],[13.75,1812],[13.775,1802],[13.8,1792],[13.825,1782],[13.85,1771],[13.875,1761],[13.9,1750],[13.925,1739],[13.95,1728],[13.975,1717],[14.0,1706],[14.025,1694],[14.05,1683],[14.075,1671],[14.1,1659],[14.125,1647],[14.15,1635],[14.175,1623],[14.2,1611],[14.225,1599],[14.25,1586],[14.275,1574],[14.3,1562],[14.325,1549],[14.35,1537],[14.375,1524],[14.4,1512],[14.425,1499],[14.45,1487],[14.475,1474],[14.5,1462],[14.525,1449],[14.55,1437],[14.575,1425],[14.6,1412],[14.625,1400],[14.65,1388],[14.675,1376],[14.7,1364],[14.725,1352],[14.75,1340],[14.775,1328],[14.8,1316],[14.825,1305],[14.85,1293],[14.875,1282],[14.9,1271],[14.925,1260],[14.95,1249],[14.975,1238],[15.0,1227],[15.025,1217],[15.05,1207],[15.075,1197],[15.1,1187],[15.125,1177],[15.15,1168],[15.175,1159],[15.2,1150],[15.225,1141],[15.25,1132],[15.275,1124],[15.3,1116],[15.325,1108],[15.35,1100],[15.375,1093],[15.4,1086],[15.425,1079],[15.45,1072],[15.475,1066],[15.5,1060],[15.525,1054],[15.55,1048],[15.575,1043],[15.6,1038],[15.625,1033],[15.65,1029],[15.675,1025],[15.7,1021],[15.725,1018],[15.75,1015],[15.775,1012],[15.8,1009],[15.825,1007],[15.85,1005],[15.875,1003],[15.9,1002],[15.925,1001],[15.95,1000],[15.975,1000],[16.0,1000],[16.025,1000],[16.05,1000],[16.075,1001],[16.1,1002],[16.125,1004],[16.15,1005],[16.175,1008],[16.2,1010],[16.225,1013],[16.25,1016],[16.275,1019],[16.3,1022],[16.325,1026],[16.35,1031],[16.375,1035],[16.4,1040],[16.425,1045],[16.45,1050],[16.475,1056],[16.5,1062],[16.525,1068],[16.55,1074],[16.575,1081],[16.6,1088],[16.625,1095],[16.65,1103],[16.675,1111],[16.7,1119],[16.725,1127],[16.75,1135],[16.775,1144],[16.8,1153],[16.825,1162],[16.85,1171],[16.875,1181],[16.9,1190],[16.925,1200],[16.95,1210],[16.975,1221],[17.0,1231],[17.025,1242],[17.05,1253],[17.075,1264],[17.1,1275],[17.125,1286],[17.15,1297],[17.175,1309],[17.2,1320],[17.225,1332],[17.25,1344],[17.275,1356],[17.3,1368],[17.325,1380],[17.35,1392],[17.375,1404],[17.4,1417],[17.425,1429],[17.45,1441],[17.475,1454],[17.5,1466],[17.525,1479],[17.55,1491],[17.575,1504],[17.6,1516],[17.625,1529],[17.65,1541],[17.675,1554],[17.7,1566],[17.725,1578],[17.75,1591],[17.775,1603],[17.8,1615],[17.825,1627],[17.85,1639],[17.875,1651],[17.9,1663],[17.925,1675],[17.95,1687],[17.975,1698],[18.0,1710],[18.025,1721],[18.05,1732],[18.075,1743],[18.1,1754],[18.125,1765],[18.15,1775],[18.175,1785],[18.2,1796],[18.225,1806],[18.25,1815],[18.275,1825],[18.3,1834],[18.325,1843],[18.35,1852],[18.375,1861],[18.4,1870],[18.425,1878],[18.45,1886],[18.475,1894],[18.5,1901],[18.525,1909],[18.55,1916],[18.575,1923],[18.6,1929],[18.625,1935],[18.65,1941],[18.675,1947],[18.7,1952],[18.725,1958],[18.75,1962],[18.775,1967],[18.8,1971],[18.825,1975],[18.85,1979],[18.875,1982],[18.9,1986],[18.925,1988],[18.95,1991],[18.975,1993],[19.0,1995],[19.025,1996],[19.05,1998],[19.075,1999],[19.1,1999],[19.125,1999],[19.15,1999],[19.175,1999],[19.2,1999],[19.225,1998],[19.25,1996],[19.275,1995],[19.3,1993],[19.325,1991],[19.35,1988],[19.375,1985],[19.4,1982],[19.425,1979],[19.45,1975],[19.475,1971],[19.5,1967],[19.525,1962],[19.55,1957],[19.575,1952],[19.6,1947],[19.625,1941],[19.65,1935],[19.675,1929],[19.7,1922],[19.725,1916],[19.75,1909],[19.775,1901],[19.8,1894],[19.825,1886],[19.85,1878],[19.875,1869],[19.9,1861],[19.925,1852],[19.95,1843],[19.975,1834]];
const samplesAvg = 20;

let lastTimestamp = data[0][0];
let position = 0; // index of data array
let timeDifference;

///////////////// Beginning of the script //////////////////

if (!data) {
    rcb.console.print("Error: data is not an array of length > 0");
    rcb.endScript();
}

rcb.files.newLogFile({prefix: filePrefix});

rcb.wait(readSensor, lastTimestamp);
function readSensor() {
    rcb.console.setVerbose(false);
    rcb.sensors.read(readDone, samplesAvg);
    rcb.console.setVerbose(true);
}
function readDone(result) {
    rcb.console.setVerbose(false);
    rcb.files.newLogEntry(result, readSensor);
    rcb.console.setVerbose(true);
}

rcb.console.print("Starting...");
rcb.console.setVerbose(true);

rcb.wait(callback, lastTimestamp);

function callback() {
    rcb.output.set("esc", data[position][1]);
    position++;
    if (data.length > position) {
        timeDifference = data[position][0] - lastTimestamp;
        lastTimestamp = data[position][0];
        rcb.wait(callback, timeDifference);
    } else {
        rcb.wait(function() {
            rcb.endScript();
        }, 1000);
    }
}
