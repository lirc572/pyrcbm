/* //////////////// generated by ulog2rcbm ////////////////
- filePrefix
- data -- [[timestamp_in_ms, pwm_output], [..., ...], ...]
- samplesAvg
///////////// User defined variables //////////// */

const filePrefix = "sin_wave";
const data = [[0.0,1500],[0.025,1501],[0.05,1502],[0.075,1503],[0.1,1504],[0.125,1506],[0.15,1507],[0.175,1508],[0.2,1509],[0.225,1511],[0.25,1512],[0.275,1513],[0.3,1514],[0.325,1516],[0.35,1517],[0.375,1518],[0.4,1519],[0.425,1521],[0.45,1522],[0.475,1523],[0.5,1524],[0.525,1526],[0.55,1527],[0.575,1528],[0.6,1529],[0.625,1531],[0.65,1532],[0.675,1533],[0.7,1534],[0.725,1536],[0.75,1537],[0.775,1538],[0.8,1539],[0.825,1541],[0.85,1542],[0.875,1543],[0.9,1544],[0.925,1546],[0.95,1547],[0.975,1548],[1.0,1549],[1.025,1551],[1.05,1552],[1.075,1553],[1.1,1554],[1.125,1556],[1.15,1557],[1.175,1558],[1.2,1559],[1.225,1561],[1.25,1562],[1.275,1563],[1.3,1564],[1.325,1566],[1.35,1567],[1.375,1568],[1.4,1569],[1.425,1571],[1.45,1572],[1.475,1573],[1.5,1574],[1.525,1575],[1.55,1577],[1.575,1578],[1.6,1579],[1.625,1580],[1.65,1582],[1.675,1583],[1.7,1584],[1.725,1585],[1.75,1587],[1.775,1588],[1.8,1589],[1.825,1590],[1.85,1591],[1.875,1593],[1.9,1594],[1.925,1595],[1.95,1596],[1.975,1598],[2.0,1599],[2.025,1600],[2.05,1601],[2.075,1603],[2.1,1604],[2.125,1605],[2.15,1606],[2.175,1607],[2.2,1609],[2.225,1610],[2.25,1611],[2.275,1612],[2.3,1613],[2.325,1615],[2.35,1616],[2.375,1617],[2.4,1618],[2.425,1620],[2.45,1621],[2.475,1622],[2.5,1623],[2.525,1624],[2.55,1626],[2.575,1627],[2.6,1628],[2.625,1629],[2.65,1630],[2.675,1632],[2.7,1633],[2.725,1634],[2.75,1635],[2.775,1636],[2.8,1638],[2.825,1639],[2.85,1640],[2.875,1641],[2.9,1642],[2.925,1644],[2.95,1645],[2.975,1646],[3.0,1647],[3.025,1648],[3.05,1650],[3.075,1651],[3.1,1652],[3.125,1653],[3.15,1654],[3.175,1656],[3.2,1657],[3.225,1658],[3.25,1659],[3.275,1660],[3.3,1662],[3.325,1663],[3.35,1664],[3.375,1665],[3.4,1666],[3.425,1667],[3.45,1669],[3.475,1670],[3.5,1671],[3.525,1672],[3.55,1673],[3.575,1674],[3.6,1676],[3.625,1677],[3.65,1678],[3.675,1679],[3.7,1680],[3.725,1681],[3.75,1683],[3.775,1684],[3.8,1685],[3.825,1686],[3.85,1687],[3.875,1688],[3.9,1690],[3.925,1691],[3.95,1692],[3.975,1693],[4.0,1694],[4.025,1695],[4.05,1697],[4.075,1698],[4.1,1699],[4.125,1700],[4.15,1701],[4.175,1702],[4.2,1703],[4.225,1705],[4.25,1706],[4.275,1707],[4.3,1708],[4.325,1709],[4.35,1710],[4.375,1711],[4.4,1712],[4.425,1714],[4.45,1715],[4.475,1716],[4.5,1717],[4.525,1718],[4.55,1719],[4.575,1720],[4.6,1721],[4.625,1723],[4.65,1724],[4.675,1725],[4.7,1726],[4.725,1727],[4.75,1728],[4.775,1729],[4.8,1730],[4.825,1731],[4.85,1733],[4.875,1734],[4.9,1735],[4.925,1736],[4.95,1737],[4.975,1738],[5.0,1739],[5.025,1740],[5.05,1741],[5.075,1742],[5.1,1744],[5.125,1745],[5.15,1746],[5.175,1747],[5.2,1748],[5.225,1749],[5.25,1750],[5.275,1751],[5.3,1752],[5.325,1753],[5.35,1754],[5.375,1755],[5.4,1757],[5.425,1758],[5.45,1759],[5.475,1760],[5.5,1761],[5.525,1762],[5.55,1763],[5.575,1764],[5.6,1765],[5.625,1766],[5.65,1767],[5.675,1768],[5.7,1769],[5.725,1770],[5.75,1771],[5.775,1772],[5.8,1774],[5.825,1775],[5.85,1776],[5.875,1777],[5.9,1778],[5.925,1779],[5.95,1780],[5.975,1781],[6.0,1782],[6.025,1783],[6.05,1784],[6.075,1785],[6.1,1786],[6.125,1787],[6.15,1788],[6.175,1789],[6.2,1790],[6.225,1791],[6.25,1792],[6.275,1793],[6.3,1794],[6.325,1795],[6.35,1796],[6.375,1797],[6.4,1798],[6.425,1799],[6.45,1800],[6.475,1801],[6.5,1802],[6.525,1803],[6.55,1804],[6.575,1805],[6.6,1806],[6.625,1807],[6.65,1808],[6.675,1809],[6.7,1810],[6.725,1811],[6.75,1812],[6.775,1813],[6.8,1814],[6.825,1815],[6.85,1816],[6.875,1817],[6.9,1818],[6.925,1819],[6.95,1820],[6.975,1821],[7.0,1822],[7.025,1823],[7.05,1824],[7.075,1824],[7.1,1825],[7.125,1826],[7.15,1827],[7.175,1828],[7.2,1829],[7.225,1830],[7.25,1831],[7.275,1832],[7.3,1833],[7.325,1834],[7.35,1835],[7.375,1836],[7.4,1837],[7.425,1838],[7.45,1838],[7.475,1839],[7.5,1840],[7.525,1841],[7.55,1842],[7.575,1843],[7.6,1844],[7.625,1845],[7.65,1846],[7.675,1847],[7.7,1848],[7.725,1848],[7.75,1849],[7.775,1850],[7.8,1851],[7.825,1852],[7.85,1853],[7.875,1854],[7.9,1855],[7.925,1856],[7.95,1856],[7.975,1857],[8.0,1858],[8.025,1859],[8.05,1860],[8.075,1861],[8.1,1862],[8.125,1863],[8.15,1863],[8.175,1864],[8.2,1865],[8.225,1866],[8.25,1867],[8.275,1868],[8.3,1868],[8.325,1869],[8.35,1870],[8.375,1871],[8.4,1872],[8.425,1873],[8.45,1873],[8.475,1874],[8.5,1875],[8.525,1876],[8.55,1877],[8.575,1878],[8.6,1878],[8.625,1879],[8.65,1880],[8.675,1881],[8.7,1882],[8.725,1882],[8.75,1883],[8.775,1884],[8.8,1885],[8.825,1886],[8.85,1886],[8.875,1887],[8.9,1888],[8.925,1889],[8.95,1890],[8.975,1890],[9.0,1891],[9.025,1892],[9.05,1893],[9.075,1893],[9.1,1894],[9.125,1895],[9.15,1896],[9.175,1897],[9.2,1897],[9.225,1898],[9.25,1899],[9.275,1900],[9.3,1900],[9.325,1901],[9.35,1902],[9.375,1903],[9.4,1903],[9.425,1904],[9.45,1905],[9.475,1905],[9.5,1906],[9.525,1907],[9.55,1908],[9.575,1908],[9.6,1909],[9.625,1910],[9.65,1911],[9.675,1911],[9.7,1912],[9.725,1913],[9.75,1913],[9.775,1914],[9.8,1915],[9.825,1915],[9.85,1916],[9.875,1917],[9.9,1918],[9.925,1918],[9.95,1919],[9.975,1920],[10.0,1920],[10.025,1921],[10.05,1922],[10.075,1922],[10.1,1923],[10.125,1924],[10.15,1924],[10.175,1925],[10.2,1926],[10.225,1926],[10.25,1927],[10.275,1928],[10.3,1928],[10.325,1929],[10.35,1929],[10.375,1930],[10.4,1931],[10.425,1931],[10.45,1932],[10.475,1933],[10.5,1933],[10.525,1934],[10.55,1934],[10.575,1935],[10.6,1936],[10.625,1936],[10.65,1937],[10.675,1937],[10.7,1938],[10.725,1939],[10.75,1939],[10.775,1940],[10.8,1940],[10.825,1941],[10.85,1942],[10.875,1942],[10.9,1943],[10.925,1943],[10.95,1944],[10.975,1945],[11.0,1945],[11.025,1946],[11.05,1946],[11.075,1947],[11.1,1947],[11.125,1948],[11.15,1948],[11.175,1949],[11.2,1950],[11.225,1950],[11.25,1951],[11.275,1951],[11.3,1952],[11.325,1952],[11.35,1953],[11.375,1953],[11.4,1954],[11.425,1954],[11.45,1955],[11.475,1955],[11.5,1956],[11.525,1956],[11.55,1957],[11.575,1957],[11.6,1958],[11.625,1958],[11.65,1959],[11.675,1959],[11.7,1960],[11.725,1960],[11.75,1961],[11.775,1961],[11.8,1962],[11.825,1962],[11.85,1963],[11.875,1963],[11.9,1964],[11.925,1964],[11.95,1965],[11.975,1965],[12.0,1966],[12.025,1966],[12.05,1966],[12.075,1967],[12.1,1967],[12.125,1968],[12.15,1968],[12.175,1969],[12.2,1969],[12.225,1969],[12.25,1970],[12.275,1970],[12.3,1971],[12.325,1971],[12.35,1972],[12.375,1972],[12.4,1972],[12.425,1973],[12.45,1973],[12.475,1974],[12.5,1974],[12.525,1974],[12.55,1975],[12.575,1975],[12.6,1976],[12.625,1976],[12.65,1976],[12.675,1977],[12.7,1977],[12.725,1977],[12.75,1978],[12.775,1978],[12.8,1979],[12.825,1979],[12.85,1979],[12.875,1980],[12.9,1980],[12.925,1980],[12.95,1981],[12.975,1981],[13.0,1981],[13.025,1982],[13.05,1982],[13.075,1982],[13.1,1983],[13.125,1983],[13.15,1983],[13.175,1984],[13.2,1984],[13.225,1984],[13.25,1984],[13.275,1985],[13.3,1985],[13.325,1985],[13.35,1986],[13.375,1986],[13.4,1986],[13.425,1987],[13.45,1987],[13.475,1987],[13.5,1987],[13.525,1988],[13.55,1988],[13.575,1988],[13.6,1988],[13.625,1989],[13.65,1989],[13.675,1989],[13.7,1989],[13.725,1990],[13.75,1990],[13.775,1990],[13.8,1990],[13.825,1991],[13.85,1991],[13.875,1991],[13.9,1991],[13.925,1992],[13.95,1992],[13.975,1992],[14.0,1992],[14.025,1992],[14.05,1993],[14.075,1993],[14.1,1993],[14.125,1993],[14.15,1993],[14.175,1994],[14.2,1994],[14.225,1994],[14.25,1994],[14.275,1994],[14.3,1995],[14.325,1995],[14.35,1995],[14.375,1995],[14.4,1995],[14.425,1995],[14.45,1996],[14.475,1996],[14.5,1996],[14.525,1996],[14.55,1996],[14.575,1996],[14.6,1996],[14.625,1997],[14.65,1997],[14.675,1997],[14.7,1997],[14.725,1997],[14.75,1997],[14.775,1997],[14.8,1997],[14.825,1998],[14.85,1998],[14.875,1998],[14.9,1998],[14.925,1998],[14.95,1998],[14.975,1998],[15.0,1998],[15.025,1998],[15.05,1998],[15.075,1998],[15.1,1999],[15.125,1999],[15.15,1999],[15.175,1999],[15.2,1999],[15.225,1999],[15.25,1999],[15.275,1999],[15.3,1999],[15.325,1999],[15.35,1999],[15.375,1999],[15.4,1999],[15.425,1999],[15.45,1999],[15.475,1999],[15.5,1999],[15.525,1999],[15.55,1999],[15.575,1999],[15.6,1999],[15.625,1999],[15.65,1999],[15.675,1999],[15.7,1999],[15.725,1999],[15.75,1999],[15.775,1999],[15.8,1999],[15.825,1999],[15.85,1999],[15.875,1999],[15.9,1999],[15.925,1999],[15.95,1999],[15.975,1999],[16.0,1999],[16.025,1999],[16.05,1999],[16.075,1999],[16.1,1999],[16.125,1999],[16.15,1999],[16.175,1999],[16.2,1999],[16.225,1999],[16.25,1999],[16.275,1999],[16.3,1999],[16.325,1999],[16.35,1998],[16.375,1998],[16.4,1998],[16.425,1998],[16.45,1998],[16.475,1998],[16.5,1998],[16.525,1998],[16.55,1998],[16.575,1998],[16.6,1998],[16.625,1997],[16.65,1997],[16.675,1997],[16.7,1997],[16.725,1997],[16.75,1997],[16.775,1997],[16.8,1997],[16.825,1996],[16.85,1996],[16.875,1996],[16.9,1996],[16.925,1996],[16.95,1996],[16.975,1995],[17.0,1995],[17.025,1995],[17.05,1995],[17.075,1995],[17.1,1995],[17.125,1994],[17.15,1994],[17.175,1994],[17.2,1994],[17.225,1994],[17.25,1994],[17.275,1993],[17.3,1993],[17.325,1993],[17.35,1993],[17.375,1993],[17.4,1992],[17.425,1992],[17.45,1992],[17.475,1992],[17.5,1991],[17.525,1991],[17.55,1991],[17.575,1991],[17.6,1991],[17.625,1990],[17.65,1990],[17.675,1990],[17.7,1990],[17.725,1989],[17.75,1989],[17.775,1989],[17.8,1989],[17.825,1988],[17.85,1988],[17.875,1988],[17.9,1988],[17.925,1987],[17.95,1987],[17.975,1987],[18.0,1986],[18.025,1986],[18.05,1986],[18.075,1986],[18.1,1985],[18.125,1985],[18.15,1985],[18.175,1984],[18.2,1984],[18.225,1984],[18.25,1983],[18.275,1983],[18.3,1983],[18.325,1982],[18.35,1982],[18.375,1982],[18.4,1981],[18.425,1981],[18.45,1981],[18.475,1980],[18.5,1980],[18.525,1980],[18.55,1979],[18.575,1979],[18.6,1979],[18.625,1978],[18.65,1978],[18.675,1978],[18.7,1977],[18.725,1977],[18.75,1977],[18.775,1976],[18.8,1976],[18.825,1975],[18.85,1975],[18.875,1975],[18.9,1974],[18.925,1974],[18.95,1973],[18.975,1973],[19.0,1973],[19.025,1972],[19.05,1972],[19.075,1971],[19.1,1971],[19.125,1971],[19.15,1970],[19.175,1970],[19.2,1969],[19.225,1969],[19.25,1968],[19.275,1968],[19.3,1968],[19.325,1967],[19.35,1967],[19.375,1966],[19.4,1966],[19.425,1965],[19.45,1965],[19.475,1964],[19.5,1964],[19.525,1964],[19.55,1963],[19.575,1963],[19.6,1962],[19.625,1962],[19.65,1961],[19.675,1961],[19.7,1960],[19.725,1960],[19.75,1959],[19.775,1959],[19.8,1958],[19.825,1958],[19.85,1957],[19.875,1957],[19.9,1956],[19.925,1956],[19.95,1955],[19.975,1955]];
const samplesAvg = 20;

let lastTimestamp = data[0][0];
let position = 0; // index of data array
let timeDifference;

///////////////// Beginning of the script //////////////////

if (!data) {
    rcb.console.print("Error: data is not an array of length > 0");
    rcb.endScript();
}

rcb.files.newLogFile({prefix: filePrefix});

rcb.wait(readSensor, lastTimestamp);
function readSensor() {
    rcb.console.setVerbose(false);
    rcb.sensors.read(readDone, samplesAvg);
    rcb.console.setVerbose(true);
}
function readDone(result) {
    rcb.console.setVerbose(false);
    rcb.files.newLogEntry(result, readSensor);
    rcb.console.setVerbose(true);
}

rcb.console.print("Starting...");
rcb.console.setVerbose(true);

rcb.wait(callback, lastTimestamp);

function callback() {
    rcb.output.set("esc", data[position][1]);
    position++;
    if (data.length > position) {
        timeDifference = data[position][0] - lastTimestamp;
        lastTimestamp = data[position][0];
        rcb.wait(callback, timeDifference);
    } else {
        rcb.wait(function() {
            rcb.endScript();
        }, 1000);
    }
}
